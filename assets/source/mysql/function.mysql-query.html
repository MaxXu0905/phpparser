<HTML  ><HEAD  ><TITLE  >mysql_query</TITLE
><META  NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK  REL="HOME" TITLE="PHP 手册" HREF="index.html"><LINK  REL="UP" TITLE="MySQL 函数库" HREF="ref.mysql.html"><LINK  REL="PREVIOUS" TITLE="mysql_ping" HREF="function.mysql-ping.html"><LINK  REL="NEXT" TITLE="mysql_real_escape_string" HREF="function.mysql-real-escape-string.html"><META  HTTP-EQUIV="Content-type" CONTENT="text/html; charset=gb2312"><LINK REL="stylesheet" HREF="style.css"></HEAD
><BODY TOPMARGIN="0" LEFTMARGIN="0"  CLASS="refentry" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#840084" ALINK="#0000FF" ><TABLE BORDER="0" WIDTH="100%" HEIGHT="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD COLSPAN="3"><DIV CLASS="NAVHEADER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR><TD><TABLE  SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0" ><TR  ><TH  COLSPAN="3" ALIGN="center" >PHP 手册</TH
></TR
><TR  ><TD  WIDTH="10%" ALIGN="left" VALIGN="bottom" ><A  HREF="function.mysql-ping.html" ACCESSKEY="P" >后退</A
></TD
><TD  WIDTH="80%" ALIGN="center" VALIGN="bottom" ></TD
><TD  WIDTH="10%" ALIGN="right" VALIGN="bottom" ><A  HREF="function.mysql-real-escape-string.html" ACCESSKEY="N" >前进</A
></TD
></TR
></TABLE></TD></TR><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR></TABLE></DIV></TD></TR><TR><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD><TD HEIGHT="100%" VALIGN="TOP" WIDTH="100%"><BR><H1  ><A  NAME="function.mysql-query" ></A
>mysql_query</H1
><DIV  CLASS="refnamediv" ><A  NAME="AEN66338" ></A
><P  >    (PHP 3, PHP 4 )</P
>mysql_query&nbsp;--&nbsp;发送一条 MySQL 查询</DIV
><DIV  CLASS="refsect1" ><A  NAME="AEN66341" ></A
><H2  >说明</H2
>resource <B  CLASS="methodname" >mysql_query</B
> ( string query [, resource link_identifier])<BR  ></BR
><P  >&#13;     <B  CLASS="function" >mysql_query()</B
>
     向与指定的连接标识符关联的服务器中的当前活动数据库发送一条查询。如果没有指定
     <TT  CLASS="parameter" ><I  >link_identifier</I
></TT
>，则使用上一个打开的连接。如果没有打开的连接，本函数会尝试无参数调用
     <A  HREF="function.mysql-connect.html" ><B  CLASS="function" >mysql_connect()</B
></A
>
     函数来建立一个连接并使用之。查询结果会被缓存。
    </P
><DIV  CLASS="note" ><BLOCKQUOTE  CLASS="note" ><P  ><B  >注: </B
>
      查询字符串不应以分号结束。
     </P
></BLOCKQUOTE
></DIV
><P  >&#13;     <B  CLASS="function" >mysql_query()</B
> 仅对
     SELECT，SHOW，EXPLAIN 或 DESCRIBE
     语句返回一个资源标识符，如果查询执行不正确则返回
     <TT  CLASS="constant" ><B  >FALSE</B
></TT
>。对于其它类型的 SQL
     语句，<B  CLASS="function" >mysql_query()</B
>
     在执行成功时返回 <TT  CLASS="constant" ><B  >TRUE</B
></TT
>，出错时返回 <TT  CLASS="constant" ><B  >FALSE</B
></TT
>。非
     <TT  CLASS="constant" ><B  >FALSE</B
></TT
> 的返回值意味着查询是合法的并能够被服务器执行。这并不说明任何有关影响到的或返回的行数。
     很有可能一条查询执行成功了但并未影响到或并未返回任何行。
    </P
><P  >&#13;     以下查询语法上有错，因此
     <B  CLASS="function" >mysql_query()</B
>
     失败并返回 <TT  CLASS="constant" ><B  >FALSE</B
></TT
>：
     <TABLE  WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="EXAMPLE" ><TR  ><TD  ><DIV  CLASS="example" ><A  NAME="AEN66368" ></A
><P  ><B  >例子 1. <B  CLASS="function" >mysql_query()</B
> 例子</B
></P
><TABLE  BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5" ><TR  ><TD  ><code ><font  color="#000000">
&lt;php<br  />$result = mysql_query("SELECT * WHERE 1=1")<br  />&nbsp;&nbsp;&nbsp;&nbsp;or die("Invalid query: " . mysql_error());<br  />?&gt;</font>
</code></TD
></TR
></TABLE
></DIV
></TD
></TR
></TABLE
>
    </P
><P  >&#13;     以下查询当
     <TT  CLASS="literal" >my_col</TT
>
     并不是表
     <TT  CLASS="literal" >my_tbl</TT
>
     中的列时语义上有错，因此
     <B  CLASS="function" >mysql_query()</B
>
     失败并返回 <TT  CLASS="constant" ><B  >FALSE</B
></TT
>：
     <TABLE  WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="EXAMPLE" ><TR  ><TD  ><DIV  CLASS="example" ><A  NAME="AEN66377" ></A
><P  ><B  >例子 2. <B  CLASS="function" >mysql_query()</B
></B
></P
><TABLE  BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5" ><TR  ><TD  ><code ><font  color="#000000">
<font  color="#0000BB">&lt;?php<br  />$result </font><font  color="#007700">= </font><font  color="#0000BB">mysql_query</font><font  color="#007700">(</font><font  color="#DD0000">"SELECT my_col FROM my_tbl"</font><font  color="#007700">)<br  />&nbsp;&nbsp;&nbsp;&nbsp;or die(</font><font  color="#DD0000">"Invalid query: " </font><font  color="#007700">. </font><font  color="#0000BB">mysql_error</font><font  color="#007700">());<br  /></font><font  color="#0000BB">?&gt;</font>
</font>
</code></TD
></TR
></TABLE
></DIV
></TD
></TR
></TABLE
>
    </P
><P  >&#13;     如果没有权限访问查询语句中引用的表时，<B  CLASS="function" >mysql_query()</B
>
     也会返回 <TT  CLASS="constant" ><B  >FALSE</B
></TT
>。
    </P
><P  >&#13;     假定查询成功，可以调用
     <A  HREF="function.mysql-num-rows.html" ><B  CLASS="function" >mysql_num_rows()</B
></A
>
     来查看对应于 SELECT
     语句返回了多少行，或者调用
     <A  HREF="function.mysql-affected-rows.html" ><B  CLASS="function" >mysql_affected_rows()</B
></A
>
     来查看对应于
     DELETE，INSERT，REPLACE 或 UPDATE
     语句影响到了多少行。
    </P
><P  >&#13;     仅对 SELECT，SHOW，DESCRIBE 或 EXPLAIN 语句
     <B  CLASS="function" >mysql_query()</B
>
     才会返回一个新的结果标识符，可以将其传递给
     <A  HREF="function.mysql-fetch-array.html" ><B  CLASS="function" >mysql_fetch_array()</B
></A
>
     和其它处理结果表的函数。处理完结果集后可以通过调用
     <A  HREF="function.mysql-free-result.html" ><B  CLASS="function" >mysql_free_result()</B
></A
>
     来释放与之关联的资源，尽管脚本执行完毕后会自动释放内存。
    </P
><P  >&#13;     参见
     <A  HREF="function.mysql-num-rows.html" ><B  CLASS="function" >mysql_num_rows()</B
></A
>，<A  HREF="function.mysql-affected-rows.html" ><B  CLASS="function" >mysql_affected_rows()</B
></A
>，<A  HREF="function.mysql-unbuffered-query.html" ><B  CLASS="function" >mysql_unbuffered_query()</B
></A
>，<A  HREF="function.mysql-free-result.html" ><B  CLASS="function" >mysql_free_result()</B
></A
>，<A  HREF="function.mysql-fetch-array.html" ><B  CLASS="function" >mysql_fetch_array()</B
></A
>，<A  HREF="function.mysql-fetch-row.html" ><B  CLASS="function" >mysql_fetch_row()</B
></A
>，<A  HREF="function.mysql-fetch-assoc.html" ><B  CLASS="function" >mysql_fetch_assoc()</B
></A
>，<A  HREF="function.mysql-result.html" ><B  CLASS="function" >mysql_result()</B
></A
>，<A  HREF="function.mysql-select-db.html" ><B  CLASS="function" >mysql_select_db()</B
></A
> 和
     <A  HREF="function.mysql-connect.html" ><B  CLASS="function" >mysql_connect()</B
></A
>。
    </P
></DIV
><BR></TD><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD></TR><TR><TD COLSPAN="3"><DIV CLASS="NAVFOOTER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR><TR><TD><TABLE  SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0" ><TR  ><TD  WIDTH="33%" ALIGN="left" VALIGN="top" ><A  HREF="function.mysql-ping.html" ACCESSKEY="P" >后退</A
></TD
><TD  WIDTH="34%" ALIGN="center" VALIGN="top" ><A  HREF="index.html" ACCESSKEY="H" >起点</A
></TD
><TD  WIDTH="33%" ALIGN="right" VALIGN="top" ><A  HREF="function.mysql-real-escape-string.html" ACCESSKEY="N" >前进</A
></TD
></TR
><TR  ><TD  WIDTH="33%" ALIGN="left" VALIGN="top" >mysql_ping</TD
><TD  WIDTH="34%" ALIGN="center" VALIGN="top" ><A  HREF="ref.mysql.html" ACCESSKEY="U" >上一级</A
></TD
><TD  WIDTH="33%" ALIGN="right" VALIGN="top" >mysql_real_escape_string</TD
></TR
></TABLE></TD></TR></TABLE></DIV></TD></TR></TABLE></BODY
></HTML
>
